<mat-toolbar>
	<mat-toolbar-row style="justify-content: space-between">
		<button mat-raised-button color="accent"
						(click)="importCandidates(selection.selected)"
						[disabled]="selection.selected.length === 0">
			<mat-icon>import_export</mat-icon>
			<span>Import Candidates</span>
		</button>
		<button mat-raised-button color="primary"
						[disabled]="dataSource?.data?.length === 0"
						matTooltip="Process 5 new candidates"
						(click)="processCandidates(5)">
			<mat-icon>import_export</mat-icon>
			<span>Process Candidates</span>
		</button>
		<a mat-button [href]="getMetricsUrl()" target="_blank">
			<mat-icon>analytics</mat-icon>
			<span>Processing Metrics</span>
		</a>
	</mat-toolbar-row>
</mat-toolbar>
<mat-progress-bar mode="buffer" *ngIf="loading" [value]="progressValue" [bufferValue]="bufferValue"></mat-progress-bar>
<mat-progress-bar mode="indeterminate" *ngIf="processing"></mat-progress-bar>

<div class="container mat-elevation-z8">
	<div class="loading-shade" *ngIf="isLoadingResults || errorWhileLoading">
		<mat-progress-bar *ngIf="isLoadingResults"></mat-progress-bar>
		<div class="rate-limit-reached" *ngIf="errorWhileLoading">
			Failed to load data due to some error.
		</div>
	</div>

	<div class="table-container">

		<table mat-table [dataSource]="dataSource" *ngIf="dataSource?.data" matSort matSortDisableClear>

			<!-- Checkbox Column -->
			<ng-container matColumnDef="select">
				<th mat-header-cell *matHeaderCellDef>
					<mat-checkbox (change)="$event ? masterToggle() : null"
												[checked]="selection.hasValue() && isAllSelected()"
												[indeterminate]="selection.hasValue() && !isAllSelected()"
												[aria-label]="checkboxLabel()">
					</mat-checkbox>
				</th>
				<td mat-cell *matCellDef="let row">
					<mat-checkbox (click)="$event.stopPropagation()"
												(change)="$event ? selection.toggle(row) : null"
												[checked]="selection.isSelected(row)"
												[aria-label]="checkboxLabel(row)">
					</mat-checkbox>
				</td>
			</ng-container>

			<!-- Task Type Column -->
			<ng-container matColumnDef="taskTypeId">
				<th mat-header-cell *matHeaderCellDef>Task Type</th>
				<td mat-cell *matCellDef="let row">{{row.taskTypeId}}</td>
			</ng-container>

			<!-- Batch Number Column -->
			<ng-container matColumnDef="batchNumber">
				<th mat-header-cell *matHeaderCellDef>Batch #</th>
				<td mat-cell *matCellDef="let row">{{row.batchNumber}}</td>
			</ng-container>

			<!-- Task ID Column -->
			<ng-container matColumnDef="taskId">
				<th mat-header-cell *matHeaderCellDef>Task ID</th>
				<td mat-cell *matCellDef="let row">{{row.taskId}}</td>
			</ng-container>

			<!-- Created Column -->
			<ng-container matColumnDef="completedAt">
				<th mat-header-cell *matHeaderCellDef mat-sort-header="completedAt" disableClear>
					Created
				</th>
				<td mat-cell *matCellDef="let row">{{row.completedAt | date : 'short'}}</td>
			</ng-container>

			<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
			<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
		</table>
	</div>

	<mat-paginator [length]="resultsLength" [pageSizeOptions]="[5, 10, 25, 100]" [pageSize]="25" showFirstLastButtons
								 aria-label="Select page of pipeline candidates"></mat-paginator>
</div>
