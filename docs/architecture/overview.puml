@startuml
'https://plantuml.com/deployment-diagram

title "Components Overview"

'Definitions'

rectangle "Frontend" {
    component "Pipeline Editor" << Angular Frontend>> as pipeline_editor
    component "Dataset Importer" << Angular Frontend >> as dataset_importer
}

rectangle "Edge Services" {
    component "API Gateway" << Ocelot Gateway>> as api_gateway
}

rectangle "Mid Level Services" {
    component "Pipeline Service" << .NET REST API >> as pipeline_service
    collections  "Node Worker" <<Python Worker>> as worker
    component "Suggestion Service" << Python REST API >> as suggestion_service
    component "Dataset Service" << Python REST API >> as dataset_service
}

rectangle "Low Level Services" {
    component "Pipeline Store" << .NET REST API >> as pipeline_store
    database "Pipeline Database" << GraphDB >> as pipeline_db
    
    component "Execution Store" << .NET REST API >> as execution_store
    database "Execution Database" << MongoDB >> as execution_db
    
    component "Dataset Store" << Python REST API >> as dataset_store
    database "Dataset Database" << MongoDB >> as dataset_db
}

component "Event Bus" << MQTT Broker >> as message_broker {
    queue "Node Execution Queue" as node_execution_queue
}

'Interaction'

pipeline_editor --> api_gateway
dataset_importer --> api_gateway

api_gateway --> pipeline_service 
api_gateway --> suggestion_service
api_gateway --> dataset_service

pipeline_store --> pipeline_db
dataset_store --> dataset_db
execution_store --> execution_db 

pipeline_service <--> node_execution_queue
node_execution_queue <--> worker 

worker --> dataset_store 
suggestion_service --> pipeline_store
pipeline_service --> execution_store
pipeline_service --> pipeline_store
dataset_service --> dataset_store
@enduml